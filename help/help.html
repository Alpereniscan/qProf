<html>

<head>
<title>qProf</title>
<style>


h5 { font-size: 95%; color: #333; }

</style>

</head>

<body>

<h1>qProf vers. 0.3.3</h1>

<div style="font-size: 90%; font-style: italic;">
	Plugin creators are M. Alberti (<a href="http:\\www.malg.eu">www.malg.eu</a>) and M. Zanieri. 
	<br />The original concept is by M. Zanieri, while the implementation is by M. Alberti. 
	<br />A few people otheer contributed with suggestions and testing. Among them we want to thank S. Peduzzi.
</div>
<br /><br />
<div>
	The purpose of this QGIS plugin is to help in the creation of geological profiles. 
	<br />
	Georeferenced data describing topography, geological outcrops and attitudes can be used as source data.
</div>

<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f01.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 1. Example of a topographic profile comprising directional slopes, created from a GPX file (data courtesy of S. Peduzzi).
</div>
<div>
	Note that currently qProf allows to project/intersect geological data (attitudes, outcrops,
	lineaments or faults) only when the profile is constituted by a straight line, with just an 
	initial and a final point. Due to this constrain, GPX file input, generally comprising multiple
	points, or profile lines with more than two points can be used to construct topographic profiles
	but the functionalities of geological data projection and intersection are not allowed on such 
	profiles. This constraint will be relaxed as much as possible in future versions, at least for geological intersection processings.
</div>
<br />
<div>A few posts describing the plugin are:
	<ul>
		<li><a href="http://gisoftw.blogspot.it/2013/03/qprof-un-nuovo-plugin-quantumgis-per-la.html">qProf: un nuovo plugin QuantumGIS per la creazione di profili topografici</a> (2013-03-16, Italian)</li>
		<li><a href="http://www.gis-blog.fr/2013/04/02/plugin-qprof-qgis/">Plugin qProf - Qgis</a> (2013-04-02, French)</li>
		<li><a href="http://gisoftw.blogspot.it/2013/10/plotting-geological-planes-in-profiles.html">Plotting geological planes in profiles with Quantum GIS</a> (2013-10-26, English) </li>
		<li><a href="http://gisoftw.blogspot.it/2014/03/qprof-supports-on-fly-reprojection-and.html">qProf supports on-the-fly reprojection and multiples profile lines</a> (2014-03-02, English)</li>
		<li><a href="http://qgis4dummies.wikidot.com/qprof">Qprof</a> (2015-06-04, Italian)</li>
		<li><a href="http://www.geokincern.com/?p=1452">Construction of geological cross sections in QGIS</a> (2016-03-01, English)</li>		
	</ul>
</div>

<h2>1. General workflow</h2>

<div>
	To construct a geological profile with qProf, the first step is to create a topographic profile, with input data represented by one or more DEMs or alternatively by a GPX file.
	<br /><br />
	Afterwards, <u>for profiles created using a line made up by just two points</u>, the user can add to the topographic profile geological data, by projecting them on the profile (e.g., geological attitudes) or intersecting them with the profile (e.g., faults, geological outcrops). This geological data are stored as point, line or polygon layers with geological attributes in the their attribute tables. In details, these processings can be:<ul>
		<li>the projection of geological attitudes on the profile section;</li>
		<li>the projection of geological lines;</li>
		<li>the intersection of geological lines (e.g., faults) on the profile section;</li>
		<li>the intersection of geological polygonal elements (e.g., outcrops) on the profile section.</li>
	</ul>

	The last step consists in exporting created datasets as graphics or GIS data, for further elaborations in graphic or 	geological software.
</div>

<br />

<h2>2. Topographic profile creation</h2>

<div>
	It is possible to create a topographic profile, by first defining its source (in the "Topographic data sources" section).
	After the profile definition, its statistics are calculated ("Profile statistics" section) and then the profile can be visualised ("Profile plot" section). 
</div>

<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f02.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 2. The plugin interface for topographic profile creation from DEMs or GPX files.
</div>

<h3>2.1 Definition of topographic data sources</h3>

<div>
	Elevation data sources may originate from:
	<ol>
		<li>one or more DEMs and a profile line, to be digitized in the map canvas or already available in a line layer;</li>
		<li>a GPX file storing track points.</li>
	</ol>

	When deriving the source data from DEMs and a line, a profile line may be digitised directy in the map canvas by using the "Digitize line" button. After activating the button, you add a point with a left click, and terminate the line with a right click. 
 	It is possible to delete the digitized line by cliking the "Clear" button. With the "Save" button it is possible to save the line as a shapefile and add it to the project.

 	<br /><br />

	The orientation of the profile source line, be it from a layer, digitized, a point list or a GPX file, can be reversed by checking the "Invert source line orientation" checkbox: the start will become the end and vice versa.
</div>

<h4>2.1.1 Topographic profile creation from DEM(s) and a line trace</h4>

<div>
	A topographic profile can be extracted from one or more DEMs, given a source profile line. This line can derive from a previously digitized line, a source line layer or a list of points. The created profile will be created using the assigned project CRS if defined. Otherwise the user will have to manually set the CRS after exporting the profile. 
</div>

<br />

<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f03.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 3. Definition of source data for DEMs and line-derived profiles.
</div>

<h5>2.1.1.2 Line stored in a layer</h5>

<div>
    When using an already existing line trace, stored in a line layer, all the elements will be used, irrespective of eventual selections in the layer.
    Multiple lines will be merged into a single line, based on the chosen order field when available,
    or otherwise based on the internal line order. Some errors in derived profiles can be due to erroneous line ordering,
    not adjusted via the choice of a correct sequential order stored in an integer field (order values start from 1).
</div>

<h5>2.1.1.3 Line from numeric input</h5>

<div>
	It is also possible to define the source profile as a list of point coordinates, in the used CRS of the project, if set, or of the used datasets.
	Each point is defined by a x-y coordinates pair, comma-separated, on a single row, for instance:
</div>

<div style="font-size: 90%; font-style: italic;">
	<br /><i>549242.7, 242942.2</i>
	<br /><i>578370.3, 322634.5</i>
</div>

<h5>2.1.1.4 Definition of input DEMs</h5>

<div>
By clicking on "DEfine source DEMs" the user can choose which of the loaded DEMs to use, also choosing the color that will represent it in the resulting profile.
</div>
<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f04.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 4. Definition of source DEMs.
</div>

<h5>2.1.1.5 Definition of line densify distance</h5>

<div>
	This is the spacing between line points, automatically added for densifying the segments. Original points are preserved and maintaned in the resulting densified line. A suggested value is automatically calculated, based on the highest resolution DEM cell size. It is advisable to use a value comparable to the resolution of the used DEM, for instance 30 m for Aster DEMs. 
 </div>

<h4>2.1.2 Topographic profile creation from GPX</h4>

<div>
	Topographic profiles can be created also using a GPX file as a source. The original latitude-longitude values are automatically converted to a WGS84-based cartesian metric values, and from those values the topographic profile is constructed.
	Beware that in the current version, only profile lines with just two points (start and end points) may be used for further geological data projections and intersections. So if you just want to create a topographic profile, GPX profile sources are fine.
	In future releases, the only-two-points constraint for geological intersections should be removed.
</div>

<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f05.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 5. The window for input GPX file choice.
</div>
<br />

<h3>2.2 Profile statistics</h3>

<div>
	The elevation statistics along the profile for each chosen DEM may be calculate with the "<i>Calculate profile statistics</i>" button.
	These statistics can be used as a help in the definition of the profile plot minimum and maximum elevations ("<i>plot z min value</i>"
	and "<i>plot z max value</i>" options). Otherwise, automatic values will be applied.
</div>

<h3>2.3 Profile plot</h3>

<div>
	The profile plot is created by using the "<i>Create profile</i>" button. 
	Values for the vertical exaggeration and minimum and maximum elevation in the plot are precomputed, however the user may modify them.

	<br /><br />

	Both height and slope can be plotted. Slopes are in degrees, and can be computed a absolute or direction values. When directional, positive values indicate upslope segments in the profile direction, while negative values indicate downslope segments. 

	<br /><br />

	With the option "<i>Flip x-axis direction</i>", the start of the x-axis in the plot will be at the right, not at the left, so that distances will increase from left to right.

	<br /><br />
	Sometimes the plot creation may require more than just a few
	seconds, so please be patient... ;)
</div>

<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f06.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 6. The window for the definition of the plot parameters.
</div>


<h2>3. Geological element projections on the profile</h2>

Having already created a topographic profile as previously described,
it is then possible to perform on the same profile the projection of geological attitudes or traces.

<h3>3.1 Projection of geological attitudes</h3>

<div>
	The source for geological attitudes is a point layer. Only selected points will be projected, unless,
	in case of no point selection, all layer points will be projected.
</div>
<br />
<div>Required fields are the geological point <i>id</i> and its surface orientation, expressed by <i>dip direction</i> or <i>right hand rule (RHR) strike</i> and <i>dip angle</i> values.
</div>
<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f07.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 7. The plugin interface for geological attitude projections on the profile.
</div>
<br />
<div>
	The geological attitudes can be projected on the section plane according to three methods:
	<ol>
		<li>nearest point;</li>
		<li>projection along a common axis;</li>
		<li> projection along individual axes, for each geological record.</li>
	</ol>
	When choosing the <i>axes from</i> option, <i>trend</i> and <i>plunge</i> fields,
	storing the fold axis values along which to project each observation, are required in the source point layer.
</div>
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f08.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 8. Example of geological attitudes projection along a profile in the eastern sector of Mt. Alpi zone (Basilicata, Southern Italy).
</div>

<br />

<h3>3.2 Projection of geological lines</h3>

<div>
	Geological traces can be projected on the section plane, based on a fold axis for which
	trend and plunge values have to be defined.
</div>
<br />
<div>
	The "<i>Line densify distance</i>" option describes the distance used to densify the lines to plot, when original points are separated by distances larger than the densify distance.
</div>
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f09.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 9. The plugin interface for geological lines projections on the profile.
</div>
<br />
<div>
	The "<i>Id field</i> is used to label the project lines in the resulting plot, as evident in Fig. 7.
</div>
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f10.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 10. Example of geological line projections on a profile in the Mt. Alpi zone (Basilicata, Southern Italy).
</div>

<br />
<h2>4. Intersections of geological elements</h2>
<div>
	It is possible to determine the intersections of the profile (composed by just two points) with lines ("<i>Intersect line layer</i>") or with polygons ("<i>Intersect polygon layer</i>"), representing geological features.
</div>
<br />
<div>
	An <i>Id</i> field and a <i>Classification</i> field can be provided, as an aid in plot visualization.</div>
<br />
<div>
	Previously created intersection can be removed by using the "<i>Reset intersections</i>" button.
</div>
<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f11.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 11. Window for line intersection.
</div>
<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f12.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 12. Example of geological polygon intersection on a profile in the Mt. Alpi zone (Basilicata, Southern Italy).
</div>

<br />
<h2>5. Result export</h2>

<div>
	The last created figure can be saved as PDF, svg or tif. The export graphic parameters can
	be saved in a text file and loaded for applying them to further plots.
	</div>
<br />
<div>
	Result data can be exported ad point/line shapefiles and/or csv files, depending on the particular type of exported data.
	The exported data will have the same CRS as the current QGis project.
</div>
<br />
<div>
	Note: the slope is saved as relative (positive when upward, negative when downward), even if plotted as absolute.
	To change to absolute value, apply the absolute function on the relative field in a GIS or spreadsheet software.
</div>
<br />
<div style="text-align:center;margin: 20px;font-size: 90%;font-style:italic;">
	<img src="images/f13.png" style="align:middle; max_width: 80%"/>
	<br /><br />Fig. 13. The plugin interface for result export.
</div>



<br />
<br />
<div style="font-size: 85%; font-style: italic;">
-----
<br /><br />
Doc version 2016-08-28, by Mauro Alberti - <a href="mailto:alberti.m65@gmail.com">alberti.m65@gmail.com</a>
</div>

<br /><br />

</body>

</html>